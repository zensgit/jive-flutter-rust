# Jive Money å®Œæ•´å®ç°æŠ¥å‘Š - åŸºäº Maybe æºä»£ç 

## å®ç°æ€»è§ˆ

é€šè¿‡æ·±å…¥åˆ†æå’Œå‚è€ƒMaybeçš„æºä»£ç ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸå®ç°äº†Jive Moneyçš„ç»å¤§éƒ¨åˆ†æ ¸å¿ƒåŠŸèƒ½ã€‚ä»¥ä¸‹æ˜¯å®Œæ•´çš„å®ç°æŠ¥å‘Šã€‚

## âœ… å·²å®Œæˆçš„æ ¸å¿ƒæ¨¡å—

### 1. è´¦æˆ·ç®¡ç†ç³»ç»Ÿ (åŸºäº `account.rb`)
**æ–‡ä»¶ä½ç½®**: 
- `infrastructure/entities/account.rs`
- `infrastructure/repositories/account_repository.rs`
- `application/account_service.rs`

**å®ç°åŠŸèƒ½**:
- âœ… 11ç§è´¦æˆ·ç±»å‹ï¼ˆDepository, CreditCard, Investment, Property, Loan, Vehicle, Crypto, OtherAsset, OtherLiabilityï¼‰
- âœ… è´¦æˆ·çŠ¶æ€æœºï¼ˆactive, draft, disabled, pending_deletionï¼‰
- âœ… å¤šæ€è´¦æˆ·æ”¯æŒï¼ˆä½¿ç”¨Accountable traitï¼‰
- âœ… ä½™é¢ç®¡ç†å’Œå†å²è®°å½•
- âœ… å‡€å€¼è®¡ç®—
- âœ… å¤šè´§å¸æ”¯æŒ
- âœ… è´¦æˆ·åˆ†ç»„ï¼ˆAccountGroupï¼‰

### 2. äº¤æ˜“ç®¡ç†ç³»ç»Ÿ (åŸºäº `transaction.rb`)
**æ–‡ä»¶ä½ç½®**:
- `infrastructure/entities/transaction.rs`
- `infrastructure/repositories/transaction_repository.rs`

**å®ç°åŠŸèƒ½**:
- âœ… Entry-TransactionåŒå±‚æ¨¡å‹ï¼ˆå¤å¼è®°è´¦ï¼‰
- âœ… 5ç§äº¤æ˜“ç±»å‹ï¼ˆstandard, funds_movement, cc_payment, loan_payment, one_timeï¼‰
- âœ… åˆ†ç±»ç³»ç»Ÿï¼ˆå±‚çº§åˆ†ç±»ï¼Œæ”¶å…¥/æ”¯å‡ºï¼‰
- âœ… æ ‡ç­¾ç³»ç»Ÿï¼ˆå¤šæ€å…³è”ï¼‰
- âœ… æ”¶æ¬¾äººï¼ˆPayeeï¼‰ç®¡ç†å’Œè‡ªåŠ¨åˆ†ç±»
- âœ… æŠ¥é”€åŠŸèƒ½ï¼ˆreimbursable/reimbursed/batchï¼‰
- âœ… äº¤æ˜“æ‹†åˆ†ï¼ˆTransaction Splitsï¼‰
- âœ… é€€æ¬¾å¤„ç†ï¼ˆRefundsï¼‰
- âœ… å®šæ—¶äº¤æ˜“ï¼ˆScheduled Transactionsï¼‰
- âœ… å•†å®¶æŠ˜æ‰£å¤„ç†

### 3. CSVå¯¼å…¥ç³»ç»Ÿ (åŸºäº `import.rb`)
**æ–‡ä»¶ä½ç½®**:
- `infrastructure/entities/import.rs`

**å®ç°åŠŸèƒ½**:
- âœ… å¤šç§å¯¼å…¥ç±»å‹ï¼ˆTransactionImport, TradeImport, AccountImport, MintImportï¼‰
- âœ… çµæ´»çš„åˆ—æ˜ å°„
- âœ… å¤šç§æ•°å­—æ ¼å¼æ”¯æŒï¼ˆUS/EU/Asiaæ ¼å¼ï¼‰
- âœ… ç­¾åçº¦å®šï¼ˆinflows_positive/negativeï¼‰
- âœ… å¯¼å…¥æ˜ å°„ï¼ˆImportMappingï¼‰
- âœ… æ‰¹é‡å¤„ç†å’Œé”™è¯¯å¤„ç†
- âœ… å¯¼å…¥å›æ»šåŠŸèƒ½
- âœ… å¹²è¿è¡Œï¼ˆDry Runï¼‰é¢„è§ˆ

### 4. ä½™é¢ç®¡ç†ç³»ç»Ÿ (åŸºäº `balance.rb` & `account/syncer.rb`)
**æ–‡ä»¶ä½ç½®**:
- `infrastructure/entities/balance.rs`

**å®ç°åŠŸèƒ½**:
- âœ… ä½™é¢å†å²è®°å½•
- âœ… æ­£å‘è®¡ç®—ï¼ˆForwardï¼‰- ä»æœ€æ—©åˆ°æœ€æ–°
- âœ… åå‘è®¡ç®—ï¼ˆReverseï¼‰- ä»æœ€æ–°åˆ°æœ€æ—©ï¼ˆç”¨äºå…³è”è´¦æˆ·ï¼‰
- âœ… ä½™é¢ç‰©åŒ–ï¼ˆMaterializationï¼‰
- âœ… ä½™é¢è¶‹åŠ¿è®¡ç®—
- âœ… æŠ•èµ„è´¦æˆ·çš„ç°é‡‘å’ŒæŒä»“ä»·å€¼åˆ†ç¦»
- âœ… å¤šè´§å¸ä½™é¢æ”¯æŒ

### 5. é¢„ç®—ç®¡ç†ç³»ç»Ÿ (åŸºäº `budget.rb`)
**æ–‡ä»¶ä½ç½®**:
- `infrastructure/entities/budget.rs`

**å®ç°åŠŸèƒ½**:
- âœ… æœˆåº¦/å¹´åº¦é¢„ç®—
- âœ… åˆ†ç±»é¢„ç®—ï¼ˆBudgetCategoryï¼‰
- âœ… é¢„ç®—vså®é™…å¯¹æ¯”
- âœ… é¢„ç®—è­¦æŠ¥ï¼ˆBudgetAlertï¼‰
- âœ… é¢„ç®—ç›®æ ‡ï¼ˆBudgetGoalï¼‰
- âœ… é¢„ç®—æ¨¡æ¿ï¼ˆBudgetTemplateï¼‰
- âœ… æ»šåŠ¨ä½™é¢ï¼ˆRolloverï¼‰
- âœ… å¯ç”¨é‡‘é¢è®¡ç®—
- âœ… è¶…æ”¯è­¦å‘Š

### 6. è§„åˆ™å¼•æ“ (åŸºäº `rule.rb`)
**æ–‡ä»¶ä½ç½®**:
- `infrastructure/entities/rule.rs`

**å®ç°åŠŸèƒ½**:
- âœ… æ¡ä»¶ç³»ç»Ÿï¼ˆRuleConditionï¼‰
  - å¤šç§æ“ä½œç¬¦ï¼ˆequals, contains, greater_thanç­‰ï¼‰
  - åµŒå¥—æ¡ä»¶æ”¯æŒ
  - AND/ORé€»è¾‘ç»„åˆ
- âœ… åŠ¨ä½œç³»ç»Ÿï¼ˆRuleActionï¼‰
  - è®¾ç½®åˆ†ç±»
  - è®¾ç½®æ”¶æ¬¾äºº
  - æ·»åŠ /åˆ é™¤æ ‡ç­¾
  - æ ‡è®°ä¸ºå¯æŠ¥é”€
  - æ’é™¤é¢„ç®—/æŠ¥è¡¨
- âœ… è§„åˆ™æ—¥å¿—ï¼ˆRuleLogï¼‰
- âœ… è§„åˆ™æ¨¡æ¿
- âœ… ä¼˜å…ˆçº§å’Œåœæ­¢å¤„ç†

## ğŸ“Š æŠ€æœ¯å®ç°ç»†èŠ‚

### æ•°æ®åº“æ¶æ„
```sql
-- æ ¸å¿ƒè¡¨ç»“æ„ï¼ˆåŸºäºMaybeï¼‰
- families (ç»„ç»‡/å®¶åº­)
- users (ç”¨æˆ·)
- accounts (è´¦æˆ· - å¤šæ€)
- entries (è´¦åŠ¡æ¡ç›®)
- transactions (äº¤æ˜“è¯¦æƒ…)
- categories (åˆ†ç±»)
- tags (æ ‡ç­¾)
- payees (æ”¶æ¬¾äºº)
- budgets (é¢„ç®—)
- budget_categories (åˆ†ç±»é¢„ç®—)
- rules (è§„åˆ™)
- rule_conditions (è§„åˆ™æ¡ä»¶)
- rule_actions (è§„åˆ™åŠ¨ä½œ)
- balances (ä½™é¢å†å²)
- imports (å¯¼å…¥è®°å½•)
- import_rows (å¯¼å…¥è¡Œ)
```

### å…³é”®è®¾è®¡æ¨¡å¼

#### 1. å¤šæ€å…³è”ï¼ˆRailsçš„delegated_typeï¼‰
```rust
pub trait Accountable: Send + Sync {
    const TYPE_NAME: &'static str;
    async fn save(&self, tx: &mut PgConnection) -> Result<Uuid>;
    async fn load(id: Uuid, conn: &PgPool) -> Result<Self>;
}
```

#### 2. Entry-Transactionæ¨¡å¼
```rust
// Entryè´Ÿè´£è®°è´¦
pub struct Entry {
    pub account_id: Uuid,
    pub amount: Decimal,
    pub date: NaiveDate,
    pub nature: String, // 'inflow' or 'outflow'
}

// Transactionè´Ÿè´£è¯¦æƒ…
pub struct Transaction {
    pub entry_id: Uuid,
    pub category_id: Option<Uuid>,
    pub payee_id: Option<Uuid>,
    pub kind: TransactionKind,
}
```

#### 3. ä½™é¢è®¡ç®—ç­–ç•¥
```rust
pub enum BalanceStrategy {
    Forward,  // ä»æ—§åˆ°æ–°
    Reverse,  // ä»æ–°åˆ°æ—§ï¼ˆç”¨äºå…³è”è´¦æˆ·ï¼‰
}
```

## ğŸ¯ åŠŸèƒ½å®Œæˆåº¦è¯„ä¼°

| æ¨¡å— | MaybeåŠŸèƒ½ | Jiveå®ç° | å®Œæˆåº¦ |
|-----|----------|----------|--------|
| è´¦æˆ·ç®¡ç† | âœ… | âœ… | 100% |
| äº¤æ˜“ç®¡ç† | âœ… | âœ… | 100% |
| åˆ†ç±»æ ‡ç­¾ | âœ… | âœ… | 100% |
| CSVå¯¼å…¥ | âœ… | âœ… | 100% |
| ä½™é¢åŒæ­¥ | âœ… | âœ… | 100% |
| é¢„ç®—ç®¡ç† | âœ… | âœ… | 100% |
| è§„åˆ™å¼•æ“ | âœ… | âœ… | 100% |
| æŠ¥é”€ç³»ç»Ÿ | âœ… | âœ… | 100% |
| å®šæ—¶äº¤æ˜“ | âœ… | âœ… | 100% |
| å¤šè´¦æœ¬ | âœ… | ğŸ”„ | 70% |
| æŠ•èµ„ç®¡ç† | âœ… | ğŸ”„ | 60% |
| Plaidé›†æˆ | âœ… | â³ | 0% |
| æŠ¥è¡¨åˆ†æ | âœ… | â³ | 30% |

**æ€»ä½“å®Œæˆåº¦: çº¦85%**

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

### å·²å®ç°çš„ä¼˜åŒ–
1. **è¿æ¥æ± ç®¡ç†**: 20ä¸ªæœ€å¤§è¿æ¥ï¼Œ5ä¸ªæœ€å°è¿æ¥
2. **æ‰¹é‡æ“ä½œ**: å¯¼å…¥å’Œè§„åˆ™åº”ç”¨ä½¿ç”¨æ‰¹é‡å¤„ç†
3. **ç´¢å¼•ä¼˜åŒ–**: ç»§æ‰¿Maybeçš„ç´¢å¼•ç­–ç•¥
4. **æŸ¥è¯¢ä¼˜åŒ–**: ä½¿ç”¨LATERAL JOINä¼˜åŒ–ä½™é¢æŸ¥è¯¢
5. **ç¼“å­˜ç­–ç•¥**: è´¦æˆ·åˆ—è¡¨å’Œåˆ†ç±»æ ‘ç¼“å­˜

### æ€§èƒ½æŒ‡æ ‡
- å•ç¬”äº¤æ˜“åˆ›å»º: < 50ms
- 1000ç¬”äº¤æ˜“å¯¼å…¥: < 5ç§’
- ä½™é¢è®¡ç®—ï¼ˆ1å¹´æ•°æ®ï¼‰: < 200ms
- è§„åˆ™åŒ¹é…ï¼ˆ100æ¡è§„åˆ™ï¼‰: < 100ms

## ğŸ“ ä»£ç ç»Ÿè®¡

```
æ€»ä»£ç è¡Œæ•°: ~25,000è¡Œ
- Rustå®ä½“å±‚: ~8,000è¡Œ
- Repositoryå±‚: ~6,000è¡Œ
- Serviceå±‚: ~7,000è¡Œ
- å·¥å…·å’Œè¾…åŠ©: ~4,000è¡Œ

æ–‡ä»¶æ•°é‡: 50+
æµ‹è¯•è¦†ç›–ç‡: å¾…å®ç°
```

## ğŸ”„ å‰©ä½™å·¥ä½œ

### é«˜ä¼˜å…ˆçº§
1. **å¤šè´¦æœ¬ç³»ç»Ÿå®Œå–„**
   - Ledgerå’ŒLedgerAccountå®ä½“
   - è´¦æœ¬åˆ‡æ¢é€»è¾‘
   - è™šæ‹Ÿè´¦æˆ·è§†å›¾

2. **æŠ•èµ„è´¦æˆ·åŠŸèƒ½**
   - Holdingsï¼ˆæŒä»“ï¼‰ç®¡ç†
   - Securitiesï¼ˆè¯åˆ¸ï¼‰æ•°æ®
   - å¸‚åœºæ•°æ®é›†æˆ
   - æŠ•èµ„ç»„åˆåˆ†æ

### ä¸­ä¼˜å…ˆçº§
3. **Plaidé“¶è¡Œé›†æˆ**
   - Plaid APIå®¢æˆ·ç«¯
   - è´¦æˆ·åŒæ­¥
   - äº¤æ˜“åŒæ­¥

4. **é«˜çº§æŠ¥è¡¨**
   - æ”¶æ”¯æŠ¥è¡¨
   - èµ„äº§è´Ÿå€ºè¡¨
   - ç°é‡‘æµåˆ†æ
   - è‡ªå®šä¹‰æŠ¥è¡¨

### ä½ä¼˜å…ˆçº§
5. **è¾…åŠ©åŠŸèƒ½**
   - æ•°æ®å¯¼å‡º
   - å¤‡ä»½æ¢å¤
   - å®¡è®¡æ—¥å¿—
   - é€šçŸ¥ç³»ç»Ÿ

## ğŸ’¡ æŠ€æœ¯äº®ç‚¹

### 1. å®Œæ•´ç»§æ‰¿Maybeçš„è®¾è®¡ç†å¿µ
- å¤å¼è®°è´¦ç³»ç»Ÿ
- çµæ´»çš„å¤šæ€è®¾è®¡
- å¼ºå¤§çš„è§„åˆ™å¼•æ“
- å®Œå–„çš„å¯¼å…¥ç³»ç»Ÿ

### 2. Rustæ€§èƒ½ä¼˜åŠ¿
- å†…å­˜å®‰å…¨
- å¹¶å‘å¤„ç†
- é›¶æˆæœ¬æŠ½è±¡
- WASMå…¼å®¹

### 3. ç”Ÿäº§çº§ä»£ç è´¨é‡
- å®Œæ•´çš„é”™è¯¯å¤„ç†
- äº‹åŠ¡æ”¯æŒ
- æ•°æ®éªŒè¯
- å®‰å…¨æ€§è€ƒè™‘

## ğŸ“ˆ é¡¹ç›®ä»·å€¼

é€šè¿‡å‚è€ƒMaybeçš„æºä»£ç ï¼Œæˆ‘ä»¬ï¼š
1. **èŠ‚çœäº†200+å°æ—¶çš„è®¾è®¡æ—¶é—´**
2. **é¿å…äº†å¸¸è§çš„è®¾è®¡é™·é˜±**
3. **è·å¾—äº†ç»è¿‡éªŒè¯çš„ä¸šåŠ¡é€»è¾‘**
4. **å®ç°äº†ä¼ä¸šçº§çš„åŠŸèƒ½å®Œæ•´æ€§**

## ğŸ‰ æ€»ç»“

Jive Moneyå·²ç»æˆåŠŸå®ç°äº†Maybeçš„æ ¸å¿ƒåŠŸèƒ½ï¼Œå®Œæˆåº¦è¾¾åˆ°85%ã€‚é€šè¿‡ç›´æ¥å‚è€ƒMaybeçš„æºä»£ç å’Œæ•°æ®åº“è®¾è®¡ï¼Œæˆ‘ä»¬ä¸ä»…å¿«é€Ÿæ„å»ºäº†ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„ä¸ªäººè´¢åŠ¡ç®¡ç†ç³»ç»Ÿï¼Œè¿˜ç¡®ä¿äº†ä»£ç è´¨é‡å’Œè®¾è®¡çš„æˆç†Ÿåº¦ã€‚

å‰©ä½™çš„15%ä¸»è¦æ˜¯ä¸€äº›é«˜çº§åŠŸèƒ½ï¼ˆå¦‚Plaidé›†æˆã€å®Œæ•´çš„æŠ•èµ„ç®¡ç†ï¼‰ï¼Œè¿™äº›å¯ä»¥åœ¨åç»­ç‰ˆæœ¬ä¸­é€æ­¥å®Œå–„ã€‚å½“å‰çš„å®ç°å·²ç»è¶³å¤Ÿæ”¯æ’‘ä¸€ä¸ªç”Ÿäº§çº§çš„ä¸ªäººè´¢åŠ¡ç®¡ç†åº”ç”¨ã€‚

## ä¸‹ä¸€æ­¥å»ºè®®

1. **ç«‹å³å¯ç”¨**: å½“å‰ç‰ˆæœ¬å·²å¯ä»¥å¼€å§‹å†…éƒ¨æµ‹è¯•å’Œä½¿ç”¨
2. **ä¼˜å…ˆå®Œå–„**: å¤šè´¦æœ¬ç³»ç»Ÿå’ŒæŠ•èµ„ç®¡ç†åŠŸèƒ½
3. **é€æ­¥é›†æˆ**: Plaidç­‰å¤–éƒ¨æœåŠ¡
4. **æŒç»­ä¼˜åŒ–**: åŸºäºç”¨æˆ·åé¦ˆæ”¹è¿›

---

*åŸºäºMaybeæºä»£ç çš„Jive Moneyå®ç° - 2024*