# è®¾è®¡æ–‡æ¡£ä¸å®ç°å¯¹æ¯”åˆ†ææŠ¥å‘Š

## ğŸ“… æŠ¥å‘Šæ—¥æœŸï¼š2025-01-06

## ğŸ“Š æ€»ä½“å¯¹æ¯”æ¦‚è§ˆ

### å·²å®ç°åŠŸèƒ½ vs è®¾è®¡è§„åˆ’

| åŠŸèƒ½æ¨¡å— | è®¾è®¡è¦æ±‚ | å®ç°çŠ¶æ€ | å®Œæˆåº¦ |
|---------|---------|---------|--------|
| **Familyç³»ç»Ÿ** | å¤šå®¶åº­ç®¡ç† | âœ… å·²å®ç° | 90% |
| **é‚€è¯·ç³»ç»Ÿ** | é‚€è¯·æˆå‘˜åŠ å…¥ | âœ… å·²å®ç° | 85% |
| **æƒé™ç®¡ç†** | è§’è‰²æƒé™æ§åˆ¶ | âœ… å·²å®ç° | 80% |
| **å®¡è®¡æ—¥å¿—** | æ“ä½œè®°å½•è¿½è¸ª | âœ… å·²å®ç° | 75% |
| **æ ‡ç­¾ç®¡ç†** | å®Œæ•´æ ‡ç­¾ç³»ç»Ÿ | âŒ æœªå®ç° | 0% |
| **åˆ†ç±»ç®¡ç†** | ä¸‰å±‚åˆ†ç±»ä½“ç³» | âŒ æœªå®ç° | 0% |
| **ç½‘ç»œåŒæ­¥** | åŠ¨æ€åŠ è½½åˆ†ç±» | âŒ æœªå®ç° | 0% |
| **äº¤æ˜“ç®¡ç†** | äº¤æ˜“CRUD | âš ï¸ éƒ¨åˆ†å®ç° | 30% |

## ğŸ” è¯¦ç»†å¯¹æ¯”åˆ†æ

### 1. æ ‡ç­¾ç®¡ç†ç³»ç»Ÿï¼ˆTAG_MANAGEMENT_SYSTEM.mdï¼‰

#### è®¾è®¡è¦æ±‚
- âœ… æ ‡ç­¾CRUDæ“ä½œ
- âœ… åˆ†ç»„ç®¡ç†ç³»ç»Ÿ
- âœ… æ™ºèƒ½æœç´¢å’Œç­›é€‰
- âœ… æ•°æ®æŒä¹…åŒ–
- âœ… å®æ—¶é¢„è§ˆ
- âœ… æ‰¹é‡æ“ä½œ
- âœ… å½’æ¡£ç®¡ç†
- âœ… ä½¿ç”¨ç»Ÿè®¡
- âœ… å“åº”å¼è®¾è®¡

#### å½“å‰å®ç°
- âŒ **å®Œå…¨æœªå®ç°**
- ç¼ºå°‘Tagæ¨¡å‹å®šä¹‰
- ç¼ºå°‘TagGroupåˆ†ç»„ç³»ç»Ÿ
- ç¼ºå°‘æ ‡ç­¾ç®¡ç†é¡µé¢
- ç¼ºå°‘æ™ºèƒ½åˆ†ç»„é€‰æ‹©å™¨

#### éœ€è¦å®ç°çš„æ ¸å¿ƒç»„ä»¶
```dart
// éœ€è¦åˆ›å»ºçš„æ–‡ä»¶
lib/models/tag.dart                    // æ ‡ç­¾æ¨¡å‹
lib/models/tag_group.dart              // æ ‡ç­¾åˆ†ç»„æ¨¡å‹
lib/screens/tags/tag_management_screen.dart
lib/widgets/tag_selector.dart
lib/widgets/group_selector.dart
lib/services/tag_service.dart
lib/providers/tag_provider.dart
```

### 2. åˆ†ç±»ç®¡ç†ç³»ç»Ÿï¼ˆCATEGORY_FEATURE_DESIGN.mdï¼‰

#### è®¾è®¡è¦æ±‚ï¼ˆä¸‰å±‚æ¶æ„ï¼‰
1. **ç³»ç»Ÿåˆ†ç±»æ¨¡æ¿**
   - ç®¡ç†å‘˜ç»´æŠ¤
   - å…¨å±€å…±äº«
   - ç‰ˆæœ¬æ§åˆ¶
   
2. **ç”¨æˆ·åˆ†ç±»**
   - ä¸ªäººå®šåˆ¶
   - è´¦æœ¬éš”ç¦»
   - å±‚çº§ç®¡ç†ï¼ˆæœ€å¤šä¸¤å±‚ï¼‰
   
3. **æ ‡ç­¾ç³»ç»Ÿ**
   - çµæ´»æ ‡è®°
   - å¤šå¯¹å¤šå…³ç³»
   - åˆ†ç±»è½¬æ ‡ç­¾åŠŸèƒ½

#### å½“å‰å®ç°
- âš ï¸ **éƒ¨åˆ†å®ç°**
- âœ… æœ‰åŸºç¡€Categoryæ¨¡å‹
- âŒ ç¼ºå°‘ç³»ç»Ÿæ¨¡æ¿å±‚
- âŒ ç¼ºå°‘åˆ†ç±»è½¬æ ‡ç­¾åŠŸèƒ½
- âŒ ç¼ºå°‘æ‰¹é‡æ“ä½œ
- âŒ ç¼ºå°‘æ‹–æ‹½æ’åº
- âŒ ç¼ºå°‘ä½¿ç”¨ç»Ÿè®¡

#### æ•°æ®åº“è¡¨ç¼ºå¤±
```sql
-- éœ€è¦åˆ›å»ºçš„è¡¨
system_category_templates  -- ç³»ç»Ÿæ¨¡æ¿
category_groups            -- åˆ†ç±»ç»„
category_batch_operations  -- æ‰¹é‡æ“ä½œè®°å½•
```

### 3. ç½‘ç»œåˆ†ç±»åŠ è½½ï¼ˆNETWORK_CATEGORY_DESIGN.mdï¼‰

#### è®¾è®¡è¦æ±‚
- åŠ¨æ€ä»æœåŠ¡å™¨åŠ è½½åˆ†ç±»æ¨¡æ¿
- å¤šçº§ç¼“å­˜æ¶æ„
- ç¦»çº¿æ”¯æŒ
- å¢é‡åŒæ­¥
- CDNå›¾æ ‡åŠ è½½

#### å½“å‰å®ç°
- âŒ **å®Œå…¨æœªå®ç°**
- ç¼ºå°‘ç½‘ç»œåŠ è½½æœºåˆ¶
- ç¼ºå°‘ç¼“å­˜ç®¡ç†
- ç¼ºå°‘ç¦»çº¿æ”¯æŒ
- ç¼ºå°‘CDNé›†æˆ

#### éœ€è¦å®ç°çš„æœåŠ¡
```dart
// éœ€è¦åˆ›å»ºçš„æœåŠ¡
lib/services/network_category_service.dart
lib/services/cache_manager.dart
lib/services/offline_manager.dart
lib/utils/icon_loader.dart
```

### 4. å·²å®ç°ä½†éœ€å®Œå–„çš„åŠŸèƒ½

#### Familyç³»ç»Ÿ
**å·²å®ç°ï¼š**
- âœ… Familyæ¨¡å‹å’ŒCRUD
- âœ… å¤šå®¶åº­åˆ‡æ¢
- âœ… æˆå‘˜ç®¡ç†
- âœ… åˆ é™¤ç¡®è®¤

**éœ€å®Œå–„ï¼š**
- âŒ å®¶åº­ç»Ÿè®¡ä¿¡æ¯
- âŒ å®¶åº­è®¾ç½®æŒä¹…åŒ–
- âŒ å®¶åº­æ´»åŠ¨æ—¥å¿—

#### é‚€è¯·ç³»ç»Ÿ
**å·²å®ç°ï¼š**
- âœ… Invitationæ¨¡å‹
- âœ… é‚€è¯·åˆ›å»ºå’Œæ¥å—
- âœ… é‚€è¯·ç®¡ç†é¡µé¢
- âœ… é‚€è¯·ç ç”Ÿæˆ

**éœ€å®Œå–„ï¼š**
- âŒ äºŒç»´ç ç”Ÿæˆ
- âŒ åˆ†äº«åŠŸèƒ½
- âŒ æ·±é“¾æ¥å¤„ç†
- âŒ é‚®ä»¶é€šçŸ¥

#### æƒé™ç³»ç»Ÿ
**å·²å®ç°ï¼š**
- âœ… PermissionService
- âœ… PermissionGuardç»„ä»¶
- âœ… è§’è‰²æƒé™å®šä¹‰

**éœ€å®Œå–„ï¼š**
- âŒ æƒé™ç¼–è¾‘ç•Œé¢
- âŒ åŠ¨æ€æƒé™åˆ†é…
- âŒ æƒé™å®¡è®¡

## ğŸ“‹ éœ€è¦å®Œå–„çš„TODOé¡¹ç›®

### ä¼˜å…ˆçº§1ï¼šæ ¸å¿ƒåŠŸèƒ½è¡¥å……ï¼ˆ1-2å‘¨ï¼‰

#### 1.1 æ ‡ç­¾ç®¡ç†ç³»ç»Ÿ
```yaml
ä»»åŠ¡æ¸…å•:
  - åˆ›å»ºTagå’ŒTagGroupæ¨¡å‹
  - å®ç°æ ‡ç­¾CRUD API
  - åˆ›å»ºæ ‡ç­¾ç®¡ç†é¡µé¢
  - å®ç°æ™ºèƒ½åˆ†ç»„é€‰æ‹©å™¨
  - æ·»åŠ æ ‡ç­¾ä½¿ç”¨ç»Ÿè®¡
  - å®ç°æ ‡ç­¾å½’æ¡£åŠŸèƒ½
```

#### 1.2 åˆ†ç±»ç®¡ç†ç³»ç»Ÿ
```yaml
ä»»åŠ¡æ¸…å•:
  - åˆ›å»ºç³»ç»Ÿæ¨¡æ¿è¡¨ç»“æ„
  - å®ç°æ¨¡æ¿å¯¼å…¥åŠŸèƒ½
  - åˆ›å»ºåˆ†ç±»ç®¡ç†é¡µé¢
  - å®ç°åˆ†ç±»è½¬æ ‡ç­¾åŠŸèƒ½
  - æ·»åŠ æ‹–æ‹½æ’åº
  - å®ç°æ‰¹é‡æ“ä½œ
```

### ä¼˜å…ˆçº§2ï¼šæ•°æ®åŒæ­¥å’Œç½‘ç»œï¼ˆ1å‘¨ï¼‰

#### 2.1 ç½‘ç»œåˆ†ç±»åŠ è½½
```yaml
ä»»åŠ¡æ¸…å•:
  - å®ç°APIå®¢æˆ·ç«¯
  - æ·»åŠ ç¼“å­˜ç®¡ç†
  - å®ç°ç¦»çº¿æ”¯æŒ
  - æ·»åŠ CDNå›¾æ ‡åŠ è½½
  - å®ç°å¢é‡åŒæ­¥
```

#### 2.2 æ•°æ®åŒæ­¥
```yaml
ä»»åŠ¡æ¸…å•:
  - å®ç°æœ¬åœ°å­˜å‚¨æœåŠ¡
  - æ·»åŠ åŒæ­¥é˜Ÿåˆ—
  - å®ç°å†²çªè§£å†³
  - æ·»åŠ åå°åŒæ­¥
```

### ä¼˜å…ˆçº§3ï¼šç”¨æˆ·ä½“éªŒå¢å¼ºï¼ˆ1å‘¨ï¼‰

#### 3.1 äº¤äº’ä¼˜åŒ–
```yaml
ä»»åŠ¡æ¸…å•:
  - æ·»åŠ æ‹–æ‹½æ”¯æŒ
  - å®ç°æ‰¹é‡é€‰æ‹©
  - æ·»åŠ æœç´¢é«˜äº®
  - å®ç°å¿«æ·æ“ä½œ
  - æ·»åŠ æ‰‹åŠ¿æ”¯æŒ
```

#### 3.2 æ€§èƒ½ä¼˜åŒ–
```yaml
ä»»åŠ¡æ¸…å•:
  - å®ç°è™šæ‹Ÿåˆ—è¡¨
  - æ·»åŠ å›¾ç‰‡ç¼“å­˜
  - ä¼˜åŒ–æ•°æ®æŸ¥è¯¢
  - å®ç°æ‡’åŠ è½½
  - æ·»åŠ é¢„åŠ è½½
```

## ğŸ”„ ç”¨æˆ·æ“ä½œæµç¨‹ä¸APIå¯¹æ¥è®¡åˆ’

### 1. æ ‡ç­¾ç®¡ç†æµç¨‹

#### å‰ç«¯æ“ä½œæµç¨‹
```mermaid
graph TD
    A[ç”¨æˆ·è¿›å…¥æ ‡ç­¾ç®¡ç†] --> B[åŠ è½½æ ‡ç­¾åˆ—è¡¨]
    B --> C{é€‰æ‹©æ“ä½œ}
    C -->|åˆ›å»º| D[å¡«å†™æ ‡ç­¾ä¿¡æ¯]
    D --> E[é€‰æ‹©åˆ†ç»„]
    E --> F[ä¿å­˜æ ‡ç­¾]
    C -->|ç¼–è¾‘| G[ä¿®æ”¹æ ‡ç­¾å±æ€§]
    C -->|åˆ é™¤| H[ç¡®è®¤åˆ é™¤]
    C -->|å½’æ¡£| I[å½’æ¡£æ ‡ç­¾]
```

#### APIå¯¹æ¥
```yaml
æ ‡ç­¾åˆ—è¡¨: GET /api/v1/tags
åˆ›å»ºæ ‡ç­¾: POST /api/v1/tags
æ›´æ–°æ ‡ç­¾: PUT /api/v1/tags/{id}
åˆ é™¤æ ‡ç­¾: DELETE /api/v1/tags/{id}
å½’æ¡£æ ‡ç­¾: POST /api/v1/tags/{id}/archive
æ ‡ç­¾ç»Ÿè®¡: GET /api/v1/tags/statistics
```

### 2. åˆ†ç±»ç®¡ç†æµç¨‹

#### å‰ç«¯æ“ä½œæµç¨‹
```mermaid
graph TD
    A[ç”¨æˆ·è¿›å…¥åˆ†ç±»ç®¡ç†] --> B[é€‰æ‹©è´¦æœ¬]
    B --> C[åŠ è½½åˆ†ç±»åˆ—è¡¨]
    C --> D{é€‰æ‹©æ“ä½œ}
    D -->|å¯¼å…¥æ¨¡æ¿| E[æµè§ˆç³»ç»Ÿæ¨¡æ¿]
    E --> F[é€‰æ‹©æ¨¡æ¿]
    F --> G[è‡ªå®šä¹‰å±æ€§]
    G --> H[å¯¼å…¥åˆ†ç±»]
    D -->|åˆ›å»ºåˆ†ç±»| I[å¡«å†™åˆ†ç±»ä¿¡æ¯]
    D -->|è½¬ä¸ºæ ‡ç­¾| J[é€‰æ‹©è½¬æ¢é€‰é¡¹]
    J --> K[æ‰§è¡Œè½¬æ¢]
```

#### APIå¯¹æ¥
```yaml
æ¨¡æ¿åˆ—è¡¨: GET /api/v1/category-templates
å¯¼å…¥æ¨¡æ¿: POST /api/v1/categories/import
åˆ†ç±»åˆ—è¡¨: GET /api/v1/categories
åˆ›å»ºåˆ†ç±»: POST /api/v1/categories
è½¬ä¸ºæ ‡ç­¾: POST /api/v1/categories/{id}/convert-to-tag
æ‰¹é‡æ“ä½œ: POST /api/v1/categories/batch
æ‹–æ‹½æ’åº: PUT /api/v1/categories/{id}/position
```

### 3. äº¤æ˜“è®°å½•æµç¨‹

#### å‰ç«¯æ“ä½œæµç¨‹
```mermaid
graph TD
    A[åˆ›å»ºäº¤æ˜“] --> B[é€‰æ‹©åˆ†ç±»]
    B --> C[è¾“å…¥é‡‘é¢]
    C --> D[æ·»åŠ æ ‡ç­¾]
    D --> E[é€‰æ‹©æ—¥æœŸ]
    E --> F[ä¿å­˜äº¤æ˜“]
    F --> G{éœ€è¦é™„ä»¶?}
    G -->|æ˜¯| H[ä¸Šä¼ é™„ä»¶]
    G -->|å¦| I[å®Œæˆ]
```

#### APIå¯¹æ¥
```yaml
åˆ›å»ºäº¤æ˜“: POST /api/v1/transactions
æ›´æ–°äº¤æ˜“: PUT /api/v1/transactions/{id}
åˆ é™¤äº¤æ˜“: DELETE /api/v1/transactions/{id}
äº¤æ˜“åˆ—è¡¨: GET /api/v1/transactions
æ‰¹é‡åˆ†ç±»: POST /api/v1/transactions/batch-categorize
æ·»åŠ æ ‡ç­¾: POST /api/v1/transactions/{id}/tags
ä¸Šä¼ é™„ä»¶: POST /api/v1/transactions/{id}/attachments
```

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„è¡¥å……

### éœ€è¦æ·»åŠ çš„ä¾èµ–
```yaml
dependencies:
  # ç½‘ç»œå’Œç¼“å­˜
  dio: ^5.3.2
  cached_network_image: ^3.3.0
  connectivity_plus: ^5.0.1
  
  # æ•°æ®æŒä¹…åŒ–
  sqflite: ^2.3.0
  shared_preferences: ^2.2.1
  hive: ^2.2.18
  
  # UIå¢å¼º
  flutter_slidable: ^3.0.0
  reorderables: ^0.6.0
  flutter_staggered_grid_view: ^0.7.0
  
  # å·¥å…·
  qr_flutter: ^4.1.0
  share_plus: ^7.2.1
  uni_links: ^0.5.1
```

### çŠ¶æ€ç®¡ç†æ¶æ„
```dart
// Providerå±‚çº§ç»“æ„
RootProvider
â”œâ”€â”€ AuthProvider
â”œâ”€â”€ FamilyProvider
â”‚   â”œâ”€â”€ CurrentFamilyProvider
â”‚   â””â”€â”€ FamilyListProvider
â”œâ”€â”€ CategoryProvider
â”‚   â”œâ”€â”€ SystemTemplateProvider
â”‚   â”œâ”€â”€ UserCategoryProvider
â”‚   â””â”€â”€ CategorySyncProvider
â”œâ”€â”€ TagProvider
â”‚   â”œâ”€â”€ TagListProvider
â”‚   â””â”€â”€ TagGroupProvider
â””â”€â”€ TransactionProvider
    â”œâ”€â”€ TransactionListProvider
    â””â”€â”€ TransactionFilterProvider
```

## ğŸ’¡ å»ºè®®å’Œä¼˜å…ˆçº§

### ç«‹å³å®æ–½ï¼ˆæœ¬å‘¨ï¼‰
1. **åˆ›å»ºåŸºç¡€æ¨¡å‹**ï¼šTagã€TagGroupã€SystemCategoryTemplate
2. **å®ç°æ ¸å¿ƒAPI**ï¼šæ ‡ç­¾CRUDã€åˆ†ç±»CRUD
3. **åˆ›å»ºç®¡ç†é¡µé¢**ï¼šæ ‡ç­¾ç®¡ç†ã€åˆ†ç±»ç®¡ç†

### çŸ­æœŸç›®æ ‡ï¼ˆ2å‘¨å†…ï¼‰
1. **å®Œå–„äº¤äº’åŠŸèƒ½**ï¼šæ‹–æ‹½ã€æ‰¹é‡æ“ä½œã€æœç´¢
2. **å®ç°æ•°æ®åŒæ­¥**ï¼šæœ¬åœ°ç¼“å­˜ã€ç½‘ç»œåŒæ­¥
3. **æ·»åŠ ç»Ÿè®¡åŠŸèƒ½**ï¼šä½¿ç”¨ç»Ÿè®¡ã€æ•°æ®åˆ†æ

### ä¸­æœŸç›®æ ‡ï¼ˆ1ä¸ªæœˆå†…ï¼‰
1. **æ€§èƒ½ä¼˜åŒ–**ï¼šè™šæ‹Ÿåˆ—è¡¨ã€æ‡’åŠ è½½ã€ç¼“å­˜ä¼˜åŒ–
2. **ç¦»çº¿æ”¯æŒ**ï¼šå®Œæ•´ç¦»çº¿åŠŸèƒ½ã€æ•°æ®å¯¼å…¥å¯¼å‡º
3. **é«˜çº§åŠŸèƒ½**ï¼šæ™ºèƒ½æ¨èã€è‡ªåŠ¨åˆ†ç±»

## ğŸ“ˆ é¢„æœŸæˆæœ

å®Œæˆæ‰€æœ‰åŠŸèƒ½åï¼ŒJive Moneyå°†å…·å¤‡ï¼š

1. **å®Œæ•´çš„è´¢åŠ¡ç®¡ç†ä½“ç³»**
   - å¤šå®¶åº­éš”ç¦»
   - çµæ´»çš„åˆ†ç±»å’Œæ ‡ç­¾
   - å¼ºå¤§çš„æƒé™æ§åˆ¶

2. **ä¼˜ç§€çš„ç”¨æˆ·ä½“éªŒ**
   - æµç•…çš„äº¤äº’
   - æ™ºèƒ½çš„æ¨è
   - ç¦»çº¿å¯ç”¨

3. **å¯æ‰©å±•çš„æ¶æ„**
   - æ¨¡å—åŒ–è®¾è®¡
   - æ¸…æ™°çš„API
   - å®Œå–„çš„æµ‹è¯•

---

**æŠ¥å‘ŠçŠ¶æ€**ï¼šâœ… å®Œæˆ
**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**ï¼šæ ¹æ®ä¼˜å…ˆçº§å¼€å§‹å®æ–½æ ‡ç­¾ç®¡ç†ç³»ç»Ÿ