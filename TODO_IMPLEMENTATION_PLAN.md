# ğŸ“‹ å¾…å®Œæˆä»»åŠ¡å®æ–½è®¡åˆ’

## ğŸ¯ æ‰§è¡Œç­–ç•¥
æŒ‰ç…§ä¼˜å…ˆçº§å’Œä¾èµ–å…³ç³»åˆ†ä¸º4ä¸ªæ‰¹æ¬¡æ‰§è¡Œï¼Œç¡®ä¿æ¯ä¸ªæ‰¹æ¬¡å®Œæˆåç³»ç»Ÿå¯æ­£å¸¸è¿è¡Œã€‚

---

## ğŸš¨ æ‰¹æ¬¡1ï¼šä¿®å¤åŸºç¡€é—®é¢˜ï¼ˆä¼˜å…ˆçº§ï¼šç´§æ€¥ï¼‰
**ç›®æ ‡**ï¼šä½¿åº”ç”¨èƒ½å¤Ÿæ­£å¸¸ç¼–è¯‘å’Œè¿è¡Œ
**é¢„è®¡æ—¶é—´**ï¼š0.5å¤©

### 1.1 ä¿®å¤ç¼–è¯‘é”™è¯¯
```yaml
ä»»åŠ¡:
  - è§£å†³Familyç±»å‘½åå†²çª
  - ä¿®å¤UserFamilyInfoç±»å‹å¼•ç”¨
  - ä¿®å¤FamilySettingså¯¼å…¥é—®é¢˜
  - å¤„ç†Colorç±»å¯¼å…¥é—®é¢˜
  - éªŒè¯åº”ç”¨å¯ä»¥æ­£å¸¸å¯åŠ¨

æ–‡ä»¶éœ€ä¿®æ”¹:
  - lib/providers/family_provider.dart
  - lib/models/family.dart
  - lib/screens/family/family_settings_screen.dart
  - lib/widgets/dialogs/delete_family_dialog.dart
```

### 1.2 æµ‹è¯•åˆ é™¤FamilyåŠŸèƒ½
```yaml
ä»»åŠ¡:
  - å¯åŠ¨åº”ç”¨æµ‹è¯•åˆ é™¤æµç¨‹
  - éªŒè¯äºŒæ¬¡ç¡®è®¤æœºåˆ¶
  - æµ‹è¯•åˆ é™¤åçš„å¯¼èˆª
  - ä¿®å¤å‘ç°çš„é—®é¢˜
```

---

## ğŸ“¦ æ‰¹æ¬¡2ï¼šå®Œæˆé‚€è¯·ç³»ç»Ÿï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰
**ç›®æ ‡**ï¼šå®ç°å®Œæ•´çš„æˆå‘˜é‚€è¯·æµç¨‹
**é¢„è®¡æ—¶é—´**ï¼š2å¤©

### 2.1 åˆ›å»ºInvitationæ¨¡å‹æ–‡ä»¶
```dart
// lib/models/invitation.dart
- InvitationåŸºç¡€æ¨¡å‹
- InvitationStatusæšä¸¾
- InvitationWithDetailså¤åˆæ¨¡å‹
- JSONåºåˆ—åŒ–æ”¯æŒ
```

### 2.2 å®ç°PendingInvitationsScreené¡µé¢
```dart
// lib/screens/invitations/pending_invitations_screen.dart
- å¾…å¤„ç†é‚€è¯·åˆ—è¡¨
- æ¥å—/æ‹’ç»åŠŸèƒ½
- åˆ·æ–°æœºåˆ¶
- é”™è¯¯å¤„ç†
```

### 2.3 åˆ›å»ºAcceptInvitationDialogç»„ä»¶
```dart
// lib/widgets/dialogs/accept_invitation_dialog.dart
- æ˜¾ç¤ºFamilyä¿¡æ¯
- æ˜¾ç¤ºé‚€è¯·è€…ä¿¡æ¯
- è§’è‰²æƒé™è¯´æ˜
- ç¡®è®¤æŒ‰é’®
```

### 2.4 åœ¨FamilySettingsæ·»åŠ é‚€è¯·ç ç®¡ç†
```dart
// æ›´æ–° lib/screens/family/family_settings_screen.dart
- æ˜¾ç¤ºå½“å‰é‚€è¯·ç 
- é‡æ–°ç”Ÿæˆé‚€è¯·ç æŒ‰é’®
- å¤åˆ¶é‚€è¯·ç åŠŸèƒ½
- é‚€è¯·å†å²è®°å½•
```

### 2.5 æ·»åŠ è·¯ç”±é…ç½®
```dart
// lib/core/router/app_router.dart
- /invitations/pending è·¯ç”±
- /invitations/accept/:code è·¯ç”±
- æ·±é“¾æ¥å¤„ç†
```

---

## ğŸ” æ‰¹æ¬¡3ï¼šå®ç°æƒé™ç³»ç»Ÿï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰
**ç›®æ ‡**ï¼šå»ºç«‹å®Œæ•´çš„æƒé™æ§åˆ¶æœºåˆ¶
**é¢„è®¡æ—¶é—´**ï¼š1.5å¤©

### 3.1 åˆ›å»ºPermissionServiceæœåŠ¡æ–‡ä»¶
```dart
// lib/services/permission_service.dart
class PermissionService {
  - 23ä¸ªæƒé™æšä¸¾å®šä¹‰
  - hasPermission()æ–¹æ³•
  - hasAnyPermission()æ–¹æ³•
  - hasAllPermissions()æ–¹æ³•
  - hasMinimumRole()æ–¹æ³•
  - å¿«æ·æƒé™æ£€æŸ¥æ–¹æ³•
}
```

### 3.2 åˆ›å»ºPermissionGuardç»„ä»¶
```dart
// lib/widgets/permission_guard.dart
class PermissionGuard extends ConsumerWidget {
  - requiredPermissionå‚æ•°
  - childå’Œfallbackç»„ä»¶
  - æƒé™æ£€æŸ¥é€»è¾‘
  - æ— æƒé™æç¤ºUI
}
```

### 3.3 åˆ›å»ºRoleGuardç»„ä»¶
```dart
// lib/widgets/role_guard.dart
class RoleGuard extends ConsumerWidget {
  - minimumRoleå‚æ•°
  - è§’è‰²å±‚çº§æ£€æŸ¥
  - å­ç»„ä»¶æ¸²æŸ“é€»è¾‘
}
```

### 3.4 é›†æˆæƒé™æ£€æŸ¥åˆ°æ‰€æœ‰æ•æ„Ÿæ“ä½œ
```yaml
éœ€è¦æ·»åŠ æƒé™æ£€æŸ¥çš„ä½ç½®:
  - åˆ é™¤FamilyæŒ‰é’® (owneræƒé™)
  - é‚€è¯·æˆå‘˜æŒ‰é’® (adminæƒé™)
  - ç§»é™¤æˆå‘˜åŠŸèƒ½ (adminæƒé™)
  - æ›´æ–°è§’è‰²åŠŸèƒ½ (adminæƒé™)
  - ç¼–è¾‘Familyè®¾ç½® (adminæƒé™)
  - åˆ›å»º/ç¼–è¾‘äº¤æ˜“ (editoræƒé™)
  - æŸ¥çœ‹æŠ¥è¡¨ (vieweræƒé™)
```

---

## ğŸ“Š æ‰¹æ¬¡4ï¼šå®¡è®¡å’Œå¢å¼ºåŠŸèƒ½ï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰
**ç›®æ ‡**ï¼šæ·»åŠ å®¡è®¡æ—¥å¿—å’Œæƒé™ç®¡ç†UI
**é¢„è®¡æ—¶é—´**ï¼š2å¤©

### 4.1 å®ç°å®¡è®¡æ—¥å¿—AuditLogæ¨¡å‹
```dart
// lib/models/audit_log.dart
class AuditLog {
  - æ“ä½œç±»å‹æšä¸¾
  - æ“ä½œè€…ä¿¡æ¯
  - æ—¶é—´æˆ³
  - å˜æ›´è¯¦æƒ…
  - IPåœ°å€
}
```

### 4.2 åˆ›å»ºAuditLogsScreené¡µé¢
```dart
// lib/screens/audit/audit_logs_screen.dart
- æ—¥å¿—åˆ—è¡¨å±•ç¤º
- æ—¶é—´èŒƒå›´ç­›é€‰
- ç”¨æˆ·ç­›é€‰
- æ“ä½œç±»å‹ç­›é€‰
- åˆ†é¡µåŠ è½½
- å¯¼å‡ºåŠŸèƒ½
```

### 4.3 å®ç°æƒé™ç¼–è¾‘PermissionEditScreen
```dart
// lib/screens/permissions/permission_edit_screen.dart
- æƒé™çŸ©é˜µUI
- è§’è‰²æ¨¡æ¿
- è‡ªå®šä¹‰æƒé™è®¾ç½®
- æ‰¹é‡æ›´æ–°
- ä¿å­˜å’Œå–æ¶ˆ
```

---

## ğŸ¨ æ‰¹æ¬¡5ï¼šç”¨æˆ·ä½“éªŒå¢å¼ºï¼ˆä¼˜å…ˆçº§ï¼šä½ï¼‰
**ç›®æ ‡**ï¼šæå‡ç”¨æˆ·ä½“éªŒå’Œæ“ä½œä¾¿åˆ©æ€§
**é¢„è®¡æ—¶é—´**ï¼š1.5å¤©

### 5.1 æ·»åŠ äºŒç»´ç ç”ŸæˆåŠŸèƒ½
```yaml
ä¾èµ–æ·»åŠ :
  - qr_flutter: ^4.1.0

å®ç°:
  - ç”Ÿæˆé‚€è¯·äºŒç»´ç 
  - äºŒç»´ç æ ·å¼å®šåˆ¶
  - ä¿å­˜äºŒç»´ç å›¾ç‰‡
```

### 5.2 åˆ›å»ºShareInvitationSheetç»„ä»¶
```dart
// lib/widgets/sheets/share_invitation_sheet.dart
- é‚€è¯·é“¾æ¥æ˜¾ç¤º
- äºŒç»´ç æ˜¾ç¤º
- å¤åˆ¶é“¾æ¥æŒ‰é’®
- åˆ†äº«åˆ°å…¶ä»–åº”ç”¨
- æœ‰æ•ˆæœŸè¯´æ˜
```

### 5.3 å®ç°æ·±é“¾æ¥å¤„ç†
```yaml
é…ç½®:
  - iOS: Info.plisté…ç½®
  - Android: AndroidManifest.xmlé…ç½®
  
å®ç°:
  - è§£æé‚€è¯·ç 
  - è·³è½¬åˆ°æ¥å—é¡µé¢
  - é”™è¯¯å¤„ç†
```

---

## ğŸ“ æ‰§è¡Œé¡ºåºå»ºè®®

### ç¬¬1å¤©
- [ ] ä¸Šåˆï¼šä¿®å¤æ‰€æœ‰ç¼–è¯‘é”™è¯¯ï¼ˆæ‰¹æ¬¡1.1ï¼‰
- [ ] ä¸‹åˆï¼šæµ‹è¯•åˆ é™¤åŠŸèƒ½å¹¶ä¿®å¤é—®é¢˜ï¼ˆæ‰¹æ¬¡1.2ï¼‰

### ç¬¬2-3å¤©
- [ ] åˆ›å»ºInvitationæ¨¡å‹ï¼ˆæ‰¹æ¬¡2.1ï¼‰
- [ ] å®ç°é‚€è¯·ç›¸å…³é¡µé¢ï¼ˆæ‰¹æ¬¡2.2-2.3ï¼‰
- [ ] é›†æˆåˆ°ç°æœ‰UIï¼ˆæ‰¹æ¬¡2.4-2.5ï¼‰

### ç¬¬4-5å¤©
- [ ] åˆ›å»ºæƒé™æœåŠ¡å’Œç»„ä»¶ï¼ˆæ‰¹æ¬¡3.1-3.3ï¼‰
- [ ] é›†æˆæƒé™æ£€æŸ¥ï¼ˆæ‰¹æ¬¡3.4ï¼‰

### ç¬¬6-7å¤©
- [ ] å®ç°å®¡è®¡æ—¥å¿—ï¼ˆæ‰¹æ¬¡4.1-4.2ï¼‰
- [ ] åˆ›å»ºæƒé™ç®¡ç†UIï¼ˆæ‰¹æ¬¡4.3ï¼‰

### ç¬¬8å¤©
- [ ] æ·»åŠ äºŒç»´ç å’Œåˆ†äº«åŠŸèƒ½ï¼ˆæ‰¹æ¬¡5.1-5.3ï¼‰
- [ ] æ•´ä½“æµ‹è¯•å’Œä¼˜åŒ–

---

## âœ… éªŒæ”¶æ ‡å‡†

### æ¯ä¸ªæ‰¹æ¬¡å®Œæˆåéœ€è¦éªŒè¯ï¼š
1. **ç¼–è¯‘é€šè¿‡**ï¼šæ— ç¼–è¯‘é”™è¯¯å’Œè­¦å‘Š
2. **åŠŸèƒ½å¯ç”¨**ï¼šæ ¸å¿ƒåŠŸèƒ½æ­£å¸¸å·¥ä½œ
3. **UIå®Œæ•´**ï¼šç•Œé¢æ˜¾ç¤ºæ­£ç¡®
4. **é”™è¯¯å¤„ç†**ï¼šå¼‚å¸¸æƒ…å†µæœ‰æç¤º
5. **ä»£ç è´¨é‡**ï¼šç¬¦åˆFlutteræœ€ä½³å®è·µ

### æœ€ç»ˆäº¤ä»˜ç‰©ï¼š
- [ ] 15ä¸ªæ–°å»ºä»£ç æ–‡ä»¶
- [ ] 5ä¸ªä¿®æ”¹çš„ç°æœ‰æ–‡ä»¶
- [ ] å®Œæ•´çš„é‚€è¯·æµç¨‹
- [ ] å®Œæ•´çš„æƒé™ç³»ç»Ÿ
- [ ] åŸºç¡€å®¡è®¡æ—¥å¿—
- [ ] æµ‹è¯•æŠ¥å‘Šæ–‡æ¡£

---

## ğŸ”§ å¼€å‘ç¯å¢ƒå‡†å¤‡

### éœ€è¦å®‰è£…çš„åŒ…
```yaml
dependencies:
  qr_flutter: ^4.1.0
  share_plus: ^7.2.1
  url_launcher: ^6.2.2
```

### è¿è¡Œå‘½ä»¤
```bash
# å®‰è£…ä¾èµ–
flutter pub get

# è¿è¡Œåº”ç”¨
flutter run -d web-server --web-port 3021

# åˆ†æä»£ç 
flutter analyze

# æ ¼å¼åŒ–ä»£ç 
flutter format lib/
```

---

## ğŸ“Š è¿›åº¦è·Ÿè¸ª

ä½¿ç”¨TodoWriteå·¥å…·è·Ÿè¸ªæ¯ä¸ªä»»åŠ¡çš„å®ŒæˆçŠ¶æ€ï¼Œç¡®ä¿ï¼š
- å¼€å§‹ä»»åŠ¡æ—¶æ ‡è®°ä¸º in_progress
- å®Œæˆåç«‹å³æ ‡è®°ä¸º completed
- é‡åˆ°é˜»å¡æ—¶è®°å½•é—®é¢˜

---

**è®¡åˆ’åˆ›å»ºæ—¥æœŸ**: 2025-01-06  
**é¢„è®¡å®Œæˆæ—¶é—´**: 8ä¸ªå·¥ä½œæ—¥  
**æ€»ä»»åŠ¡æ•°**: 15ä¸ªä¸»è¦ä»»åŠ¡  
**å½“å‰çŠ¶æ€**: å¾…å¼€å§‹