# 🚀 快速验证清单

**验证时间**: 预计5-10分钟
**测试环境**: http://localhost:3021

---

## ✅ 功能验证清单

### 准备工作 (1分钟)

- [ ] 确认服务运行中
  ```bash
  # API服务检查
  curl http://localhost:8012/

  # 应该返回: {"name":"Jive Money API",...}
  ```

- [ ] 打开浏览器访问 http://localhost:3021
- [ ] 登录测试账号
  - Email: `testcurrency@example.com`
  - Password: `Test1234`

---

### 功能 1: 即时自动汇率显示 (3分钟)

#### 步骤 1: 设置手动汇率
- [ ] 点击"设置" → "多币种设置"
- [ ] 启用"启用多币种"开关（如未启用）
- [ ] 选择一个货币（例如USD）
- [ ] 为该货币设置手动汇率: `7.5000`
- [ ] 保存并返回

#### 步骤 2: 验证手动汇率
- [ ] 确认该货币显示"手动汇率"标识
- [ ] 汇率值显示为 `7.5000`

#### 步骤 3: 清除并观察 ⭐
- [ ] 进入"手动汇率覆盖"页面
- [ ] 点击"清除所有手动汇率"
- [ ] **关键检查**: 页面**不刷新**的情况下，自动汇率立即显示
- [ ] 汇率值变更为自动值（不再是7.5000）
- [ ] "手动汇率"标识消失

**结果**:
- ✅ 通过 - 自动汇率立即显示，无需刷新
- ❌ 失败 - 需要刷新页面才能看到

---

### 功能 2: 智能货币排序 (3分钟)

#### 步骤 1: 设置多个手动汇率
- [ ] 为以下货币设置手动汇率：
  - USD: `7.5000`
  - EUR: `8.2000`
  - JPY: `0.0520`
- [ ] 保存所有设置

#### 步骤 2: 检查排序 ⭐
- [ ] 进入货币选择页面/货币列表
- [ ] **关键检查**: 货币显示顺序为：
  1. 基础货币（CNY）在最顶部
  2. USD、EUR、JPY 紧跟在基础货币下方
  3. 其他货币显示在更下方

#### 步骤 3: 动态测试
- [ ] 添加一个新的手动汇率（例如GBP）
- [ ] 返回货币列表
- [ ] 确认GBP自动移到基础货币下方

- [ ] 清除USD的手动汇率
- [ ] 返回货币列表
- [ ] 确认USD移到非手动汇率区域

**结果**:
- ✅ 通过 - 手动汇率货币始终在基础货币下方
- ❌ 失败 - 货币顺序混乱

---

## 📊 验证结果

### 测试信息
- **测试人员**: _____________
- **测试时间**: _____________
- **浏览器**: Chrome / Firefox / Safari / Edge (选择一项)

### 功能状态
- [ ] **功能1**: ✅ 通过 / ❌ 失败 / ⚠️ 部分通过
- [ ] **功能2**: ✅ 通过 / ❌ 失败 / ⚠️ 部分通过

### 问题记录
```
如有问题，请在此记录：



```

---

## 🔧 故障排查

### 功能1问题

**症状**: 清除手动汇率后，自动汇率没有立即显示

**检查**:
1. 打开浏览器开发者工具（F12）
2. 查看Console标签是否有错误
3. 查看Network标签，确认API请求成功
4. 手动刷新页面，验证数据是否正确

**常见原因**:
- 网络请求失败
- API服务未运行
- Redis缓存未启动

### 功能2问题

**症状**: 手动汇率货币没有在基础货币下方

**检查**:
1. 确认手动汇率已成功设置（有"手动汇率"标识）
2. 清除浏览器缓存后重试
3. 检查货币数据中的`source`字段

**常见原因**:
- 前端代码未更新
- 排序逻辑未执行
- 数据缓存问题

---

## ✨ 预期效果示例

### 功能1 - 操作流程

```
1. 设置手动汇率
   USD: 7.5000 [手动汇率]

2. 点击"清除所有手动汇率"

3. 无需刷新，立即看到：
   USD: 7.1364 [自动汇率]
   ↑ 页面未刷新，数据已更新
```

### 功能2 - 列表排序

```
货币列表显示：

⭐ CNY 人民币 (基础货币)
━━━━━━━━━━━━━━━━━━━
📌 USD 美元 (手动: 7.5000)
📌 EUR 欧元 (手动: 8.2000)
📌 JPY 日元 (手动: 0.0520)
━━━━━━━━━━━━━━━━━━━
GBP 英镑 (自动汇率)
AUD 澳元 (自动汇率)
CAD 加元 (自动汇率)
...
```

---

## 📝 快速命令参考

### 重启服务
```bash
# 重启API
cd jive-api
DATABASE_URL="postgresql://postgres:postgres@localhost:5433/jive_money" \
REDIS_URL="redis://localhost:6380" \
API_PORT=8012 \
cargo run

# 重启Flutter
cd jive-flutter
flutter run -d web-server --web-port 3021
```

### API测试
```bash
# 登录
curl -X POST 'http://localhost:8012/api/v1/auth/login' \
  -H 'Content-Type: application/json' \
  -d '{"email": "testcurrency@example.com", "password": "Test1234"}'

# 查询汇率
curl -X GET 'http://localhost:8012/api/v1/currencies/rate?from=CNY&to=USD' \
  -H 'Authorization: Bearer YOUR_TOKEN'
```

---

## 📚 相关文档

- 详细验证指南: `claudedocs/MANUAL_VERIFICATION_GUIDE.md`
- 实现报告: `claudedocs/CURRENCY_FEATURES_IMPLEMENTATION_REPORT.md`
- 自动化测试: `test_currency_features.sh`

---

**快速验证完成！** 🎉

如果两项功能都通过测试，恭喜您！新功能已成功部署。

如有任何问题，请参考详细验证指南或查看相关文档。
